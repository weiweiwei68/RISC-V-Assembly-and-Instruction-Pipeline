count_leading_zeros(unsigned long long):
        addi    sp,sp,-144
        sw      ra,140(sp)
        sw      s0,136(sp)
        sw      s2,132(sp)
        sw      s3,128(sp)
        sw      s4,124(sp)
        sw      s5,120(sp)
        sw      s6,116(sp)
        sw      s7,112(sp)
        sw      s8,108(sp)
        sw      s9,104(sp)
        sw      s10,100(sp)
        sw      s11,96(sp)
        addi    s0,sp,144
        sw      a0,-56(s0)
        sw      a1,-52(s0)
        lw      a5,-52(s0)
        slli    a4,a5,31
        lw      a5,-56(s0)
        srli    a2,a5,1
        or      a2,a4,a2
        lw      a5,-52(s0)
        srli    a3,a5,1
        lw      a5,-56(s0)
        or      t5,a5,a2
        lw      a5,-52(s0)
        or      t6,a5,a3
        sw      t5,-56(s0)
        sw      t6,-52(s0)
        lw      a5,-52(s0)
        slli    a4,a5,30
        lw      a5,-56(s0)
        srli    a6,a5,2
        or      a6,a4,a6
        lw      a5,-52(s0)
        srli    a7,a5,2
        lw      a5,-56(s0)
        or      a5,a5,a6
        sw      a5,-104(s0)
        lw      a5,-52(s0)
        or      a5,a5,a7
        sw      a5,-100(s0)
        lw      a5,-104(s0)
        lw      a6,-100(s0)
        sw      a5,-56(s0)
        sw      a6,-52(s0)
        lw      a5,-52(s0)
        slli    a4,a5,28
        lw      a5,-56(s0)
        srli    t3,a5,4
        or      t3,a4,t3
        lw      a5,-52(s0)
        srli    t4,a5,4
        lw      a5,-56(s0)
        or      a5,a5,t3
        sw      a5,-112(s0)
        lw      a5,-52(s0)
        or      a5,a5,t4
        sw      a5,-108(s0)
        lw      a5,-112(s0)
        lw      a6,-108(s0)
        sw      a5,-56(s0)
        sw      a6,-52(s0)
        lw      a5,-52(s0)
        slli    a4,a5,24
        lw      a5,-56(s0)
        srli    a5,a5,8
        sw      a5,-64(s0)
        lw      a5,-64(s0)
        or      a5,a4,a5
        sw      a5,-64(s0)
        lw      a5,-52(s0)
        srli    a5,a5,8
        sw      a5,-60(s0)
        lw      a5,-56(s0)
        lw      a3,-64(s0)
        lw      a4,-60(s0)
        mv      a2,a3
        or      a5,a5,a2
        sw      a5,-120(s0)
        lw      a5,-52(s0)
        or      a5,a5,a4
        sw      a5,-116(s0)
        lw      a5,-120(s0)
        lw      a6,-116(s0)
        sw      a5,-56(s0)
        sw      a6,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,16
        lw      a4,-56(s0)
        srli    s10,a4,16
        or      s10,a5,s10
        lw      a5,-52(s0)
        srli    s11,a5,16
        lw      a5,-56(s0)
        or      a5,a5,s10
        sw      a5,-128(s0)
        lw      a5,-52(s0)
        or      a5,a5,s11
        sw      a5,-124(s0)
        lw      a5,-128(s0)
        lw      a6,-124(s0)
        sw      a5,-56(s0)
        sw      a6,-52(s0)
        lw      a5,-52(s0)
        srli    a5,a5,0
        sw      a5,-72(s0)
        sw      zero,-68(s0)
        lw      a5,-56(s0)
        lw      a3,-72(s0)
        lw      a4,-68(s0)
        mv      a2,a3
        or      a5,a5,a2
        sw      a5,-136(s0)
        lw      a5,-52(s0)
        or      a5,a5,a4
        sw      a5,-132(s0)
        lw      a5,-136(s0)
        lw      a6,-132(s0)
        sw      a5,-56(s0)
        sw      a6,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,31
        lw      a4,-56(s0)
        srli    s8,a4,1
        or      s8,a5,s8
        lw      a5,-52(s0)
        srli    s9,a5,1
        li      a5,1431654400
        addi    a5,a5,1365
        and     a5,s8,a5
        sw      a5,-80(s0)
        li      a5,1431654400
        addi    a5,a5,1365
        and     a5,s9,a5
        sw      a5,-76(s0)
        lw      a2,-56(s0)
        lw      a3,-52(s0)
        lw      a6,-80(s0)
        lw      a7,-76(s0)
        mv      a1,a6
        sub     a4,a2,a1
        mv      a1,a4
        sgtu    a1,a1,a2
        mv      a0,a7
        sub     a5,a3,a0
        sub     a3,a5,a1
        mv      a5,a3
        sw      a4,-56(s0)
        sw      a5,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,30
        lw      a4,-56(s0)
        srli    s6,a4,2
        or      s6,a5,s6
        lw      a5,-52(s0)
        srli    s7,a5,2
        li      a5,858992640
        addi    a5,a5,819
        and     a5,s6,a5
        sw      a5,-88(s0)
        li      a5,858992640
        addi    a5,a5,819
        and     a5,s7,a5
        sw      a5,-84(s0)
        lw      a4,-56(s0)
        li      a5,858992640
        addi    a5,a5,819
        and     a5,a4,a5
        sw      a5,-96(s0)
        lw      a4,-52(s0)
        li      a5,858992640
        addi    a5,a5,819
        and     a5,a4,a5
        sw      a5,-92(s0)
        lw      a1,-88(s0)
        lw      a2,-84(s0)
        mv      a3,a1
        lw      a6,-96(s0)
        lw      a7,-92(s0)
        mv      a0,a6
        add     a4,a3,a0
        mv      a3,a4
        mv      a0,a1
        sltu    a3,a3,a0
        mv      a1,a7
        add     a5,a2,a1
        add     a3,a3,a5
        mv      a5,a3
        sw      a4,-56(s0)
        sw      a5,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,28
        lw      a4,-56(s0)
        srli    t1,a4,4
        or      t1,a5,t1
        lw      a5,-52(s0)
        srli    t2,a5,4
        lw      a2,-56(s0)
        lw      a3,-52(s0)
        add     a4,t1,a2
        mv      a1,a4
        sltu    a1,a1,t1
        add     a5,t2,a3
        add     a3,a1,a5
        mv      a5,a3
        li      a3,252645376
        addi    a3,a3,-241
        and     a3,a4,a3
        sw      a3,-56(s0)
        li      a3,252645376
        addi    a3,a3,-241
        and     a5,a5,a3
        sw      a5,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,24
        lw      a4,-56(s0)
        srli    s4,a4,8
        or      s4,a5,s4
        lw      a5,-52(s0)
        srli    s5,a5,8
        lw      a2,-56(s0)
        lw      a3,-52(s0)
        add     a4,a2,s4
        mv      a1,a4
        sltu    a1,a1,a2
        add     a5,a3,s5
        add     a3,a1,a5
        mv      a5,a3
        sw      a4,-56(s0)
        sw      a5,-52(s0)
        lw      a5,-52(s0)
        slli    a5,a5,16
        lw      a4,-56(s0)
        srli    s2,a4,16
        or      s2,a5,s2
        lw      a5,-52(s0)
        srli    s3,a5,16
        lw      a2,-56(s0)
        lw      a3,-52(s0)
        add     a4,a2,s2
        mv      a1,a4
        sltu    a1,a1,a2
        add     a5,a3,s3
        add     a3,a1,a5
        mv      a5,a3
        sw      a4,-56(s0)
        sw      a5,-52(s0)
        lhu     a5,-56(s0)
        andi    a5,a5,127
        slli    a5,a5,16
        srli    a5,a5,16
        li      a4,64
        sub     a5,a4,a5
        slli    a5,a5,16
        srli    a5,a5,16
        mv      a0,a5
        lw      ra,140(sp)
        lw      s0,136(sp)
        lw      s2,132(sp)
        lw      s3,128(sp)
        lw      s4,124(sp)
        lw      s5,120(sp)
        lw      s6,116(sp)
        lw      s7,112(sp)
        lw      s8,108(sp)
        lw      s9,104(sp)
        lw      s10,100(sp)
        lw      s11,96(sp)
        addi    sp,sp,144
        jr      ra
buffer_overflow_attack(char*):
        addi    sp,sp,-48
        sw      ra,44(sp)
        sw      s0,40(sp)
        addi    s0,sp,48
        sw      a0,-36(s0)
        li      a4,-559038464
        addi    a4,a4,-273
        li      a5,0
        sw      a4,-24(s0)
        sw      a5,-20(s0)
        lw      a5,-36(s0)
        addi    a3,a5,4
        lw      a4,-24(s0)
        lw      a5,-20(s0)
        sw      a4,0(a3)
        sw      a5,4(a3)
        nop
        lw      ra,44(sp)
        lw      s0,40(sp)
        addi    sp,sp,48
        jr      ra
.LC1:
        .string "Buffer overflow detected! The value start to be different at %d bits from left.\n"
.LC2:
        .string "No buffer overflow detected."
main:
        addi    sp,sp,-80
        sw      ra,76(sp)
        sw      s0,72(sp)
        sw      s2,68(sp)
        sw      s3,64(sp)
        addi    s0,sp,80
        lui     a5,%hi(.LC0)
        lw      a4,%lo(.LC0)(a5)
        lw      a5,%lo(.LC0+4)(a5)
        sw      a4,-24(s0)
        sw      a5,-20(s0)
        addi    a3,s0,-68
        lw      a4,-24(s0)
        lw      a5,-20(s0)
        sw      a4,0(a3)
        sw      a5,4(a3)
        addi    a5,s0,-68
        mv      a0,a5
        call    buffer_overflow_attack(char*)
        addi    a5,s0,-68
        lw      a4,0(a5)
        lw      a5,4(a5)
        sw      a4,-32(s0)
        sw      a5,-28(s0)
        lw      a4,-32(s0)
        lw      a5,-24(s0)
        xor     s2,a4,a5
        lw      a4,-28(s0)
        lw      a5,-20(s0)
        xor     s3,a4,a5
        mv      a0,s2
        mv      a1,s3
        call    count_leading_zeros(unsigned long long)
        mv      a5,a0
        sh      a5,-34(s0)
        lhu     a4,-34(s0)
        li      a5,64
        beq     a4,a5,.L5
        lhu     a5,-34(s0)
        addi    a5,a5,1
        mv      a1,a5
        lui     a5,%hi(.LC1)
        addi    a0,a5,%lo(.LC1)
        call    printf
        j       .L6
.L5:
        lui     a5,%hi(.LC2)
        addi    a0,a5,%lo(.LC2)
        call    puts
.L6:
        li      a5,0
        mv      a0,a5
        lw      ra,76(sp)
        lw      s0,72(sp)
        lw      s2,68(sp)
        lw      s3,64(sp)
        addi    sp,sp,80
        jr      ra
.LC0:
        .word   -1698898192
        .word   305419896